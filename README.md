# Sleep_eat_rice
羊了个羊干了个饭算法

该项目主要是为了解决一个np-hard的干饭问题。

这是一个羊了个羊干饭的高效算法，经检验比市面上存在的算法更容易拿到更高分。

本项目基于C++，跟python/JavaScript的版本相比，这个算法的运行速度快很多。

该项目采用截图，识图，解题，点击4个exe完成。

截图部分要求：Windows2003及以后的系统（xp及以下不确定是否可用）

识图的部分要求：windows7 及之后的系统，依赖性为opencv。

解题部分要求：这是一个核心算法，任何有实现标准库的运行环境。这部分没有任何要求，可以在任何实现了c++标准库的地方使用。

点击部分要求：Windows98及以后系统（xp下不确定是否可用）

编译说明：使用visual stidio编译

运行说明：下载"x64/Release/ "下的所有压缩文件，解压3个.zip文件并放在同一目录下，这两个dll因为超过25M限制不得不压缩，这2dll的来源是opencv4410编译后的结果。

运行run.bat(需要UAC权限，因为使用了窗口点击函数）

配置说明：

截图部分：这个很显然，只有一个参数传入，就是窗口名。

scp.exe -windowTitle "羊了个羊：星球"

识图部分：

参数在opr_axis.txt中，第一行是行坐标，第二行是列坐标，如果识图异常可以修改。 原理是把它切分成16*10的网格然后再识图。

核心算法：
老算法

参数在config.txt，内容有

max_try=1000000 //这是最大尝试次数，数字越大时间越久，建议控制在1分钟内完成

target =160 //目标分数，如果找到目标分数会提前终止，也可以留160越高越好嘛毕竟

max_thread = 16 //最大线程数，建议数值为CPU线程数

giveup_on_no_increase=100000 //如果在某个分支尝试超过这个值，就会放弃该分支转而搜索其它分支

random_entry_deep=27 //随机进入的层数，这东西一般没有什么用。具体用途看源码，非必要默认就行

新算法corev4多了一个控制时间的选项。这里就不说名了。

还有一个初始化内存占用的选项，这个也不说了，自己研究。（太大了浪费空间，太小了浪费时间）

感谢robin_hook提供的哈希表，比自带的快很多。
感谢xxhash提供的哈希函数计算，这个比自带的碰撞率和性能都好很多（对于这个数据集）

然后新算法不提供编译好的二进制文件，需要按需编译。

建议编译选项：

C++20 64位

禁用异常。以便获取极致的速度（程序内没有使用异常，真有异常直接崩溃得了）

建议使用AVX512指令集，如果CPU不支持可以选择AVX2，再不行就AVX。实在不行自己看着办吧。（针对向量化做了优化）






点击部分：

click_mouse.exe -windowTitle "羊了个羊：星球" -kx 0.087362 -bx 0.107088 -ky 0.047693 -by 0.193443

窗口名不另外说明了，kx,bx,ky,by这是把核心算法输出的坐标转化成程序坐标的用途，一般也无需修改。

