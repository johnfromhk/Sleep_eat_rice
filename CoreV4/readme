这是最先版本的核心算法，完全重构版的，速度比旧版快1-2个数量级
具体可以自行阅读代码。
